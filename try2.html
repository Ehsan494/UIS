<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>APS Interactive Demo – Frontier Quest</title>
  <style>
    body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; background: #f0f4f8; margin:0; padding:0; }
    h1 { margin-top: 20px; color: #2c3e50; }
    #story { 
      width: 80%; max-width: 800px; background: white; border-radius: 8px; 
      padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 10px;
      line-height: 1.5; color: #34495e;
    }
    #story p { margin: 10px 0; }
    #instructions {
      font-size: 0.95em; color: #555; margin-bottom: 10px;
      text-align: center;
    }
    .containers { display: flex; gap: 20px; margin-top: 20px; }
    .box {
      border: 2px solid #444; padding: 10px; width: 120px; min-height: 140px;
      background: #fff; border-radius: 6px;
      display: flex; flex-wrap: wrap; gap: 5px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    .box h3 { margin: 0 0 10px 0; font-size: 1em; text-align: center; color: #2c3e50; }
    .item {
      width: 24px; height: 24px; line-height: 24px; text-align: center;
      border-radius: 4px; background: steelblue; color: white; cursor: pointer;
      user-select: none; transition: transform .2s;
    }
    .item:hover { transform: scale(1.2); }
    .host { background: crimson !important; cursor: default; }
    .R    { background: orange  !important; cursor: default; }
    .RK   { background: green   !important; cursor: default; }
    .RKp  { background: purple  !important; cursor: default; }
    .NDS  { background: blue    !important; cursor: default; }
    #hostBox { margin-top: 10px; font-weight: bold; color: #2c3e50; }
    button { margin: 5px; padding: 8px 12px; border:none; background:#2980b9; color:white; border-radius:4px; cursor:pointer; }
    button:hover { background:#1f618d; }
    #log { margin-top: 15px; width: 80%; max-width: 800px; height: 120px; 
           border: 1px solid #ccc; padding: 10px; overflow-y: auto; 
           background: white; border-radius:4px; box-shadow: 0 1px 4px rgba(0,0,0,0.1); }
  </style>
</head>
<body>

  <h1>Frontier Quest: Learn APS by Playing</h1>
  <div id="story">
    <p>Welcome, Commander! Our goal is to extract the first “frontier” of champions from six brave tribes (A–F), each measured by two strengths (f₁ and f₂).</p>
    <p>We’ll do this using the <em>Arena-Principle Sorting</em> algorithm (APS), which iteratively selects a champion (“host”), has them duel the others, and peels off the non-dominated set (the Pareto front).</p>
    <p style="font-weight:bold">Follow the steps below and play the simulation to see APS in action—minimizing unnecessary duels!</p>
  </div>

  <div id="instructions">
    <p>1) Pick a champion → 2) Click any blue tribe in Q to duel → 3) Watch it move to R, RK, or be dropped → 4) When Q empties, champion joins NDS → 5) Refill Q and repeat!</p>
  </div>

  <div id="hostBox">Host: <span id="hostLabel">–</span></div>
  <button id="pickHost">Pick Champion</button>
  <button id="reset">Restart Quest</button>

  <div class="containers">
    <div class="box" id="Q"><h3>Q (Working Tribes)</h3></div>
    <div class="box" id="R"><h3>R (Retreated)</h3></div>
    <div class="box" id="RK"><h3>RK (Allied Retreads)</h3></div>
    <div class="box" id="RKp"><h3>RK′</h3></div>
    <div class="box" id="NDS"><h3>Frontier (NDS)</h3></div>
  </div>

  <div id="log"></div>

  <script>
  const points = {A:[1,3],B:[2.5,2],C:[3,1.5],D:[2,3.5],E:[3.5,2.5],F:[1.5,1.5]};
  const dominates = (a,b)=> a[0]<=b[0] && a[1]<=b[1] && (a[0]<b[0]||a[1]<b[1]);
  let Q, R, RK, host, NDS;
  const logDiv = document.getElementById('log');
  function log(msg){ const p=document.createElement('div'); p.innerHTML=msg; logDiv.appendChild(p); logDiv.scrollTop=logDiv.scrollHeight;}
  function renderBox(id, arr, cls){
    const box=document.getElementById(id);
    box.querySelectorAll('.item').forEach(n=>n.remove());
    arr.forEach(l=>{
      const d=document.createElement('div');
      d.textContent=l; d.className='item '+(cls||'');
      box.appendChild(d);
    });
  }
  function renderAll(){ renderBox('Q',Q); renderBox('R',R,'R'); renderBox('RK',RK,'RK'); renderBox('RKp',[], 'RKp'); renderBox('NDS',NDS,'NDS'); }
  function resetAll(){
    Q=Object.keys(points); R=[]; RK=[]; NDS=[]; host=null;
    document.getElementById('hostLabel').textContent='–'; logDiv.innerHTML=''; renderAll();
  }
  document.getElementById('reset').onclick=resetAll;
  document.getElementById('pickHost').onclick=()=>{
    if(!Q.length)return;
    host=Q.splice(Math.floor(Math.random()*Q.length),1)[0];
    document.getElementById('hostLabel').textContent=host;
    log(`<b>Champion:</b> ${host}`); renderAll();
  };
  document.getElementById('Q').addEventListener('click',e=>{
    if(!host){ alert('Pick a champion first!'); return; }
    if(!e.target.classList.contains('item'))return;
    const y=e.target.textContent;
    if(!Q.includes(y))return;
    Q=Q.filter(z=>z!==y);
    const x=host, ax=points[x], ay=points[y];
    if(dominates(ax,ay)){ log(`${x} ≺ ${y} → ${y} vanishes`); }
    else if(dominates(ay,ax)){ log(`${y} ≺ ${x} → ${y} is new champion; allies→RK`); RK=RK.concat(R); R=[]; host=y; document.getElementById('hostLabel').textContent=host; }
    else { log(`${x} ∦ ${y} → ${y} retreats to R`); R.push(y); }
    renderAll();
    if(!Q.length){
      const RKp = RK.filter(z=>!dominates(points[host],points[z]));
      log(`Q empty → RK′ = [${RKp.join()}]`); renderBox('RKp',RKp,'RKp');
      NDS.push(host); log(`<b>${host}</b> joins the frontier`); renderBox('NDS',NDS,'NDS');
      const nextQ = RKp.concat(R);
      if(nextQ.length>1){ Q=nextQ; R=[]; RK=[]; log(`New Q=[${Q.join()}] → pick champion`); host=null; document.getElementById('hostLabel').textContent='–'; renderAll(); }
      else if(nextQ.length===1){ NDS.push(nextQ[0]); log(`Last hero ${nextQ[0]} added → frontier complete!`); Q=[]; R=[]; RK=[]; renderAll(); }
      else log(`No remaining heroes → frontier complete!`);
    }
  });
  resetAll();
  </script>

</body>
</html>
